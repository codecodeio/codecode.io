---
import CategoryCloud from "@components/category-cloud/CategoryCloud.astro";
import Pagination from "@components/pagination/Pagination.astro";
import { getAllPosts } from "@js/blogUtils";
import { setCacheHeaders } from "@js/cacheHeaders";
import { getLocaleFromUrl } from "@js/localeUtils";
import BaseLayout from "@layouts/BaseLayout.astro";
import BlogIndexLayout from "@layouts/BlogIndexGridDetailed.astro";
import type { Page } from "astro";

import { defaultLocale } from "@/config/siteSettings.json";

export async function getStaticPaths({ paginate }) {
  const posts = await getAllPosts(defaultLocale);

  return paginate(posts, {
    pageSize: 6,
  });
}
const { page } = Astro.props as { page: Page };

setCacheHeaders(Astro);
---

<BaseLayout
	title="Blog posts"
	description="Learn from my blog posts about web development, design, and more."
>
	<div class="site-container mt-24 md:mt-36">
		<!-- Stars -->
		<div class="stars-bg" aria-hidden="true">
			<div class="stars"></div>
			<div class="stars2"></div>
		</div>
		<!-- Header -->
		<div class="mx-auto mb-16 max-w-7xl">
			<div class="grid gap-8 md:grid-cols-5">
				<!-- Left Column - Blog Heading -->
				<div class="text-center md:col-span-3 md:text-left">
					<!-- <h1 class="h2 mb-4">Blog</h1> -->
					<p class="description opacity-80 lg:text-xl">
						Explore articles on development and everything tech
					</p>
				</div>

				<!-- Right Column - Tags Box -->
				<div
					class="bg-base-100 dark:bg-base-900 flex flex-col items-center justify-center rounded-2xl p-6 text-center md:col-span-2 md:items-start md:text-left"
				>
					<h2 class="mb-4 text-lg font-bold">Categories</h2>
					<CategoryCloud showCount={true} class="justify-center md:justify-start" />
				</div>
			</div>
		</div>

		<!-- Blog Posts Grid -->
    <BlogIndexLayout posts={page.data} class="mt-10 pb-12 md:pb-24" />
    <Pagination
        basePath={`/blog/`}
        prevUrl={page.url.prev}
        currPage={page.currentPage}
        nextUrl={page.url.next}
        lastPage={page.lastPage}
      />
	</div>
</BaseLayout>
